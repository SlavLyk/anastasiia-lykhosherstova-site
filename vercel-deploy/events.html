<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Events — Anastasiia Lykhosherstova</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .events-page { padding: 0 72px 96px; }

    .events-intro-row {
      display: flex; align-items: end; justify-content: space-between;
      padding: 72px 0 60px;
      gap: 40px;
      border-bottom: 1px solid rgba(201,165,90,0.12);
    }
    .events-sub {
      font-size: 14px; line-height: 1.85;
      color: rgba(247,243,236,0.5);
      max-width: 380px;
    }

    /* Filter tabs */
    .filter-tabs {
      display: flex; gap: 2px;
      margin: 40px 0 0;
    }
    .filter-tab {
      padding: 10px 24px;
      font-size: 10px; letter-spacing: 0.2em;
      text-transform: uppercase; color: rgba(247,243,236,0.4);
      background: var(--charcoal);
      border: none; cursor: pointer;
      transition: background 0.2s, color 0.2s;
      font-family: 'Jost', sans-serif;
    }
    .filter-tab.active, .filter-tab:hover {
      background: var(--mid); color: var(--gold);
    }

    /* Event list */
    .events-list { margin-top: 4px; }
    .event-row {
      display: grid;
      grid-template-columns: 110px 1fr 140px 100px;
      gap: 32px; align-items: center;
      padding: 32px 32px;
      background: var(--charcoal);
      margin-bottom: 2px;
      position: relative;
      transition: background 0.22s, padding-left 0.22s;
    }
    .event-row::before {
      content: ''; position: absolute;
      left: 0; top: 0; bottom: 0; width: 2px;
      background: var(--gold);
      transform: scaleY(0); transform-origin: bottom;
      transition: transform 0.3s ease;
    }
    .event-row:hover::before { transform: scaleY(1); }
    .event-row:hover { background: var(--mid); padding-left: 40px; }

    .event-date-box {
      text-align: center;
      padding: 12px;
      border: 1px solid rgba(201,165,90,0.15);
    }
    .event-date-day {
      font-family: 'Cormorant Garamond', serif;
      font-size: 38px; font-weight: 300;
      color: var(--gold); line-height: 1;
    }
    .event-date-month {
      font-size: 9px; letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(247,243,236,0.4);
      margin-top: 4px;
    }
    .event-name {
      font-family: 'Cormorant Garamond', serif;
      font-size: 26px; font-weight: 400;
      color: var(--ivory); margin-bottom: 6px;
    }
    .event-location {
      font-size: 12px; color: rgba(247,243,236,0.38);
      letter-spacing: 0.06em;
    }
    .event-badge {
      font-size: 9px; letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(201,165,90,0.7);
      background: rgba(201,165,90,0.08);
      border: 1px solid rgba(201,165,90,0.18);
      padding: 7px 14px;
      text-align: center;
      white-space: nowrap;
    }
    .event-link {
      font-size: 10px; letter-spacing: 0.16em;
      text-transform: uppercase;
      color: rgba(247,243,236,0.38);
      text-decoration: none;
      transition: color 0.2s;
      text-align: right;
    }
    .event-link:hover { color: var(--gold); }

    /* Past events section */
    .past-section { margin-top: 72px; }
    .past-title {
      font-size: 10px; letter-spacing: 0.26em;
      text-transform: uppercase; color: rgba(247,243,236,0.3);
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(247,243,236,0.07);
      margin-bottom: 0;
    }
    .past-row {
      display: grid;
      grid-template-columns: 110px 1fr 140px;
      gap: 32px; align-items: center;
      padding: 22px 32px;
      border-bottom: 1px solid rgba(247,243,236,0.05);
      opacity: 0.45;
    }
    .past-date {
      font-size: 12px; color: rgba(247,243,236,0.5);
      letter-spacing: 0.06em;
    }
    .past-name {
      font-family: 'Cormorant Garamond', serif;
      font-size: 20px; font-weight: 400; color: var(--ivory);
    }
    .past-loc {
      font-size: 11px; color: rgba(247,243,236,0.3); letter-spacing: 0.05em;
    }

    .events-loading {
      padding: 48px 0;
      font-size: 13px; letter-spacing: 0.08em;
      color: rgba(247,243,236,0.3);
      font-family: 'Jost', sans-serif;
    }
    @media (max-width: 860px) {
      .events-page { padding: 0 28px 72px; }
      .events-intro-row { flex-direction: column; gap: 20px; padding: 48px 0 40px; }
      .event-row { grid-template-columns: 80px 1fr; padding: 24px 20px; }
      .event-badge, .event-link { display: none; }
      .past-row { grid-template-columns: 80px 1fr; padding: 18px 0; }
      .past-loc { display: none; }
    }
  </style>
</head>
<body>
<div class="page">

  <div class="page-hero">
    <div class="page-eyebrow reveal">Calendar</div>
    <h1 class="reveal">Upcoming <em>Events</em></h1>
  </div>

  <div class="events-page">

    <div class="events-intro-row">
      <div></div>
      <p class="events-sub reveal">Upcoming public performances and bookings. For private event enquiries, please get in touch directly.</p>
    </div>

    <div class="filter-tabs">
      <button class="filter-tab active" data-filter="All">All</button>
      <button class="filter-tab" data-filter="Wedding">Weddings</button>
      <button class="filter-tab" data-filter="Concert">Concerts</button>
      <button class="filter-tab" data-filter="Corporate">Corporate</button>
    </div>

    <div class="events-list" id="eventsList">
      <div class="events-loading">Loading events...</div>
    </div>

    <!-- Past Events -->
    <div class="past-section reveal" id="pastSection">
      <div class="past-title">Past Performances</div>
      <div id="pastList"></div>
    </div>

  </div>

</div>
<script src="shared.js"></script>
<script>
  // ── NOTION EVENTS INTEGRATION ──────────────────────────────────────────
  // Events are fetched from /api/events (a Vercel serverless function)
  // which securely talks to Notion. To add events, open Notion and edit
  // the "Anastasiia Lykhosherstova — Events" database. Tick "Visible on Site"
  // to make an event appear here.

  async function loadEvents() {
    const list   = document.getElementById('eventsList');
    const past   = document.getElementById('pastList');
    const today  = new Date().toISOString().split('T')[0];

    try {
      const res    = await fetch('/api/events');
      const events = await res.json();

      const upcoming = events.filter(e => e.date >= today);
      const past_ev  = events.filter(e => e.date <  today).reverse();

      // Render upcoming
      list.innerHTML = upcoming.length ? upcoming.map(renderEventRow).join('') : '<p style="padding:40px 0;color:rgba(247,243,236,0.35);font-family:\'Jost\',sans-serif;font-size:13px;">No upcoming events scheduled at this time.</p>';

      // Render past
      past.innerHTML = past_ev.length ? past_ev.map(renderPastRow).join('') : '';
      if (!past_ev.length) document.getElementById('pastSection').style.display = 'none';

    } catch (err) {
      // Fallback: show placeholder message
      list.innerHTML = '<p style="padding:40px 0;color:rgba(247,243,236,0.35);font-family:\'Jost\',sans-serif;font-size:13px;">Events loading — please check back soon.</p>';
      console.warn('Notion fetch failed. Have you set NOTION_TOKEN and set up a proxy?', err);
    }
  }

  function formatDate(iso) {
    if (!iso) return {day:'—',month:'—'};
    const d = new Date(iso + 'T00:00:00');
    return {
      day:   d.getDate().toString().padStart(2,'0'),
      month: d.toLocaleDateString('en-GB',{month:'short',year:'numeric'}),
    };
  }

  function renderEventRow(e) {
    const {day, month} = formatDate(e.date);
    return `
      <div class="event-row">
        <div class="event-date-box">
          <div class="event-date-day">${day}</div>
          <div class="event-date-month">${month}</div>
        </div>
        <div>
          <div class="event-name">${e.name}</div>
          <div class="event-location">${e.loc}</div>
        </div>
        <div class="event-badge">${e.type}</div>
        <a href="contact.html" class="event-link">Enquire →</a>
      </div>`;
  }

  function renderPastRow(e) {
    const {day, month} = formatDate(e.date);
    return `
      <div class="past-row">
        <div class="past-date">${month}</div>
        <div class="past-name">${e.name}</div>
        <div class="past-loc">${e.loc}</div>
      </div>`;
  }

  // Filter tabs
  document.querySelectorAll('.filter-tab').forEach(btn => {
    btn.addEventListener('click', function() {
      document.querySelectorAll('.filter-tab').forEach(b => b.classList.remove('active'));
      this.classList.add('active');
      const filter = this.dataset.filter;
      document.querySelectorAll('.event-row').forEach(row => {
        const badge = row.querySelector('.event-badge')?.textContent ?? '';
        row.style.display = (filter === 'All' || badge === filter) ? '' : 'none';
      });
    });
  });

  loadEvents();
</script>
</body>
</html>
